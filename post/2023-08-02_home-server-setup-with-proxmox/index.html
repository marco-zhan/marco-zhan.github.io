<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Marco's Tech Blog"><meta property="og:type" content="article"><meta property="og:image" content="https://blog.marcozh.com///header_image.jpeg"><meta property="twitter:image" content="https://blog.marcozh.com///header_image.jpeg"><meta name=title content="Home Server Setup with Proxmox"><meta property="og:title" content="Home Server Setup with Proxmox"><meta property="twitter:title" content="Home Server Setup with Proxmox"><meta name=description content="Setting up my home server with proxmox"><meta property="og:description" content="Setting up my home server with proxmox"><meta property="twitter:description" content="Setting up my home server with proxmox"><meta property="twitter:card" content="summary"><meta name=keyword content="Marco, Tech, AWS, Kubernetes, Docker"><link rel="shortcut icon" href=/img/favicon.ico><title>Home Server Setup with Proxmox | Marco's Tech Blog</title><link rel=canonical href=/post/2023-08-02_home-server-setup-with-proxmox/><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/css/zanshang.css><link href=https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.1/css/all.css rel=stylesheet type=text/css><script src=/js/jquery.min.js></script>
<script src=/js/bootstrap.min.js></script>
<script src=/js/hux-blog.min.js></script>
<script src=/js/lazysizes.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=/>Marco's Tech Blog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/>All Posts</a></li><li><a href=/categories/aws>aws</a></li><li><a href=/categories/general>general</a></li><li><a href=/categories/tech>tech</a></li><li><a href=https://resume.marcozh.com>Resume</a></li><li><a href=/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/header_image.jpeg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=/tags/tag1 title=tag1>tag1</a>
<a class=tag href=/tags/tag2 title=tag2>tag2</a></div><h1>Home Server Setup with Proxmox</h1><h2 class=subheading></h2><span class=meta>Posted by
Marco
on
Wednesday, August 2, 2023</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><h2 id=introduction>Introduction</h2><p>I have been wanting to setup a home server for a while, and finally got a chance to do it.
I have been using a Raspberry Pi 4 stack as my home server for a while, but it is not powerful
enough to run some of the services I want to run, also, my initial purpose to setup a home server was
to explore Kubernetes, scalability becomes an issue as I would like to run multiple nodes. So, instead of
buying another few Pis and setup a bigger cluster, I decided to get a proper server with some virtualization.
I have a Desktop PC under my table with Windows 10 installed, but I hardly use it, so I decided to wipe everything
and turn it into a home server.</p><p>I have been using Proxmox at work for a while, and I am quite familiar with it, so I decided to use it as my virtualization
tool. Proxmox is a Debian based virtualization tool, it is free and open source, and it is quite easy to use.
There are other options like VMware, but I am not familiar with it, and I don&rsquo;t want to spend too much time on learning.</p><h2 id=hardware>Hardware</h2><p>I have a Desktop PC with the following specs:</p><ul><li>CPU: Intel i9</li><li>RAM: 64GB</li><li>SSD: 2TB</li><li>Motherboard: ASUS Motherboard with 2 network cards</li><li>GPU: NVIDIA GeForce RTX 2080 Ti</li><li>Power Supply: 750W</li></ul><p>The most important thing here is the CPU and RAM, as I want to run multiple VMs and Kubernetes.</p><h2 id=setting-up-proxmox>Setting up Proxmox</h2><p>I am not going to go through the installation process, as it is quite straightforward. You can download the ISO
from <a href=https://www.proxmox.com/en/downloads/category/iso-images-pve>here</a>, and follow the installation guide <a href=https://pve.proxmox.com/wiki/Installation>here</a>.</p><h2 id=network-setup>Network setup</h2><p>For security practice, and also to practice my network skills. I decided to setup a separate network for my home server and hide
Proxmox server node behind. After some research, I decided to use <a href=https://www.pfsense.org/>pfSense</a> as my router and
the single point of entry to my home server network. pfSense is a free and open source firewall and router. The ISO can be downloaded
from <a href=https://www.pfsense.org/download/>here</a>. It takes a while form me to setup the network but eventually I got it working.
The below diagram shows the network setup.</p><p><img src=/home-server-network-setup.png alt="Network setup"></p><p>Something to note here:</p><ul><li>My Desktop PC has two network cards on the Motherboard, one is connected to the room AP, the other one is connected to the switch.
Even though the switch is only used for connecting to my Pi 4s, for some reason the enp2s0 interface is not activated unless
I plug a network cable connecting it to the switch</li><li>pfSense VM is connected to both network interfaces, and it is acting as the gateway of the home server network</li><li>All other VMs are connected to the home server network interface only</li><li>DHCP is enabled on the pfSense VM, and it is serving IP addresses to all the VMs in the home server network</li><li>After pfSense gives an IP to the proxmox server, I setup a static IP for it, so that I can remember it easily</li><li>Proxmox server and all the VMs are connected to the home server network and therefore cannot be connected from outside</li><li>pfSense VM will also give IP address to connected devices from the switch using DHCP</li><li>pfSense also has a plugin for tailScale, which I can install on the pfSense VM so I can access my home server anywhere
in the world</li></ul><h2 id=whats-next>What&rsquo;s next</h2><p>Now that I have the network setup, I can start to setup the VMs and Kubernetes. I will write another post about how I setup</p><hr><ul class=pager><li class=previous><a href=/post/2023-03-29_i-accidentally-deleted-very-important-data-and-introspection/ data-toggle=tooltip data-placement=top title="I Accidentally Deleted Important Data... What Happened and Introspection">&larr;
Previous Post</a></li></ul><div id=disqus-comment></div><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//https-marco-zhan-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:yixiao5898@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/marco-zhan><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/marcozhan/><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; Marco's Tech Blog 2023<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> by <a href=https://zhaohuabing.com>Huabing</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){t=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),n=$(this).text(),i=$('<a href="'+o+'" rel="nofollow">'+n+"</a>"),s=$('<li class="'+t+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>